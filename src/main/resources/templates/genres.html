<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NovelWeb - Thể loại</title>
  <style>
    html, body {
      overflow-x: hidden;
      overflow-y: auto;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #FCEAB5;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    .container {
      width: 80%;
      margin: auto;
      overflow: hidden;
    }

    .header {
      background-color: #EC3323;
      color: #fff;
      padding: 10px 0;
      width: 100%;
      text-align: center;
    }

    .logo-text {
      font-size: 50px;
      font-weight: bold;
      margin: 0;
    }

    .top-bar {
      background-color: #F18833;
      color: #fff;
      padding: 10px 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
      width: 100%;
      position: relative;
    }

    .center {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-grow: 1;
    }

    .account-link {
      position: absolute;
      right: 100px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      margin-right: 45px;
    }

    .account-link img {
      width: 20px;
      margin-right: 5px;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background-color: white;
      border-radius: 5px;
      padding: 5px;
    }

    .search-input {
      border: none;
      border-radius: 5px;
      height: 30px;
      flex-grow: 1;
      padding: 0 10px;
    }

    .search-button {
      background-color: #fff;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
    }

    .search-button img {
      width: 30px;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 110px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      top: 100%;
      z-index: 1;
      overflow: hidden;
      white-space: nowrap;
    }

    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    .dropdown-content a:hover {
      background-color: #f1f1f1;
    }

    .account-link:hover .dropdown-content {
      display: block;
    }

    .navigation-bar {
      background-color: #F18833;
      color: #fff;
      padding: 10px 0;
      display: flex;
      justify-content: space-around;
      width: 100%;
    }

    .navigation-bar a {
      color: #fff;
      text-decoration: none;
      padding: 10px;
      font-size: 16px;
    }

    .navigation-bar a:hover {
      background-color: #ffac59;
      border-radius: 5px;
    }

    .home-icon {
      width: 35px;
      vertical-align: middle;
    }

    .content {
      padding: 20px 0;
      width: 100%;
    }

    .genre-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px 0;
    }

    .genre-item {
      background-color: #EC3323;
      color: #fff;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
    }

    .genre-item.selected {
      background-color: #F18833;
    }

    .confirm-button {
      background-color: #28a745;
      color: #fff;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
    }

    .confirm-button:hover {
      background-color: #218838;
    }

    footer {
      background-color: #333;
      color: #fff;
      text-align: center;
      padding: 10px 0;
      width: 100%;
      position: relative;
      margin-top: auto;
    }

    .rectangle-line {
      background-color: #fee9cf;
      width: 100%;
      position: relative;
      z-index: 1;
      margin-top: 2px;
    }
  </style>
</head>
<body>
<div class="header">
  <span class="logo-text">NovelWeb</span>
</div>
<header class="top-bar">
  <div class="container">
    <div class="center">
      <div class="search-bar">
        <input type="text" placeholder="Tìm kiếm tên truyện..." class="search-input">
        <button class="search-button"><img src="https://icon-library.com/images/search-icon-white/search-icon-white-27.jpg" alt="Search"></button>
      </div>
    </div>
  </div>
  <span class="account-link">
        <img src="https://raw.githubusercontent.com/pck313/ImageWeb/refs/heads/main/userlogo.png" alt="User Icon">
        Tài khoản
        <div class="dropdown-content">
            <a href="login.html">Đăng nhập</a>
            <a href="register.html">Đăng ký</a>
        </div>
    </span>
</header>

<div class="rectangle-line"></div>

<nav class="navigation-bar">
  <div class="container">
    <a href="index.html"><img src="https://icon-library.com/images/home-icon-white/home-icon-white-7.jpg" alt="Trang chủ" class="home-icon"></a>
    <a href="history.html">Lịch sử</a>
    <a href="genres.html">Thể loại</a>
    <a href="search.html">Tìm truyện</a>
  </div>
</nav>
<main class="content">
  <div class="container">
    <h2>Chọn thể loại</h2>
    <div class="genre-list">
      <div class="genre-item" onclick="selectGenre(this, 'action')">Action</div>
      <div class="genre-item" onclick="selectGenre(this, 'adventure')">Adventure</div>
      <div class="genre-item" onclick="selectGenre(this, 'comedy')">Comedy</div>
      <div class="genre-item" onclick="selectGenre(this, 'drama')">Drama</div>
      <div class="genre-item" onclick="selectGenre(this, 'fantasy')">Fantasy</div>
      <div class="genre-item" onclick="selectGenre(this, 'horror')">Horror</div>
      <div class="genre-item" onclick="selectGenre(this, 'romance')">Romance</div>
      <div class="genre-item" onclick="selectGenre(this, 'sci-fi')">Sci-Fi</div>
      <!-- Thêm các thể loại khác ở đây -->
    </div>
    <button class="confirm-button" onclick="confirmGenres()">Xác nhận</button>
    <div id="genre-results">
      <!-- Kết quả tìm kiếm thể loại sẽ hiển thị ở đây -->
    </div>
  </div>
</main>

<footer>
  <div class="container">
    <p>&copy; 2024 NovelWeb. All rights reserved.</p>
  </div>
</footer>

<script>
  var selectedGenres = [];

  function selectGenre(element, genre) {
    var index = selectedGenres.indexOf(genre);
    if (index > -1) {
      selectedGenres.splice(index, 1);
      element.classList.remove('selected');
    } else {
      selectedGenres.push(genre);
      element.classList.add('selected');
    }
  }

  function confirmGenres() {
    var url = '/api/genres?' + selectedGenres.map(g => 'genre=' + g).join('&');
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.onload = function() {
      if (xhr.status === 200) {
        var results = JSON.parse(xhr.responseText);
        var output = '<h2>Kết quả cho các thể loại: ' + selectedGenres.join(', ') + '</h2>';
        output += '<ul>';
        results.forEach(function(story) {
          output += '<li>' + story.title + '</li>';
        });
        output += '</ul>';
        document.getElementById('genre-results').innerHTML = output;
      }
    };
    xhr.send();
  }
</script>

<script>
  function addToHistory(title, image, url) {
    var history = JSON.parse(localStorage.getItem('history')) || [];
    // Kiểm tra xem truyện đã tồn tại trong lịch sử chưa
    if (!history.some(item => item.url === url)) {
      history.push({ title: title, image: image, url: url });
      localStorage.setItem('history', JSON.stringify(history));
    }
  }

  // Ví dụ sử dụng: gọi addToHistory khi người dùng nhấn vào truyện
  document.querySelectorAll('.story-item').forEach(function(item) {
    item.addEventListener('click', function() {
      var title = this.getAttribute('data-title');
      var image = this.getAttribute('data-image');
      var url = this.getAttribute('data-url');
      addToHistory(title, image, url);
    });
  });
</script>

</body>
</html>
